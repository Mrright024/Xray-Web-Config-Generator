:root{
  --bg:#0b0c10; --panel:#12141b; --panel2:#0f1117; --text:#e8eaf0; --muted:#a8adbd;
  --border:#232636; --accent:#6ea8fe; --danger:#ff6b6b; --ok:#51cf66; --warn:#ffd43b;
  --shadow: 0 8px 24px rgba(0,0,0,.35);
  --radius: 14px;
  --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  --sans: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji","Segoe UI Emoji";
}
@media (prefers-color-scheme: light){
  :root{
    --bg:#f6f7fb; --panel:#ffffff; --panel2:#fbfcff; --text:#141824; --muted:#5b6274;
    --border:#e6e8f0; --accent:#2f6feb; --danger:#e03131; --ok:#2f9e44; --warn:#f08c00;
    --shadow: 0 10px 24px rgba(20,24,36,.08);
  }
}
*{box-sizing:border-box}
body{margin:0;background:var(--bg);color:var(--text);font-family:var(--sans);line-height:1.45}
a{color:var(--accent);text-decoration:none}
a:hover{text-decoration:underline}

.app{display:grid;grid-template-rows:56px 1fr;height:100dvh}
header{
  display:flex;align-items:center;justify-content:space-between;
  padding:0 14px;border-bottom:1px solid var(--border);
  background:linear-gradient(180deg,var(--panel),var(--panel2));
  position:sticky;top:0;z-index:20;
}
.brand{display:flex;align-items:center;gap:10px;font-weight:650}
.brand-title{font-weight:750}
.pill{padding:4px 10px;border:1px solid var(--border);border-radius:999px;color:var(--muted);font-size:12px;background:rgba(255,255,255,.03)}
.btn{
  appearance:none;border:1px solid var(--border);background:var(--panel);color:var(--text);
  padding:8px 12px;border-radius:10px;cursor:pointer;
}
.btn:hover{border-color:rgba(110,168,254,.55)}
.btn:active{transform:translateY(1px)}
.btn.primary{background:rgba(110,168,254,.12);border-color:rgba(110,168,254,.45)}
.btn.danger{background:rgba(255,107,107,.10);border-color:rgba(255,107,107,.35)}
.btn.ghost{background:transparent}
.btn.small{padding:6px 10px;border-radius:9px;font-size:13px}

.toolbar{display:flex;align-items:center;gap:8px;flex-wrap:wrap}
.seg{display:inline-flex;border:1px solid var(--border);border-radius:999px;overflow:hidden}
.seg button{border:0;background:transparent;color:var(--muted);padding:8px 10px;cursor:pointer;font-size:13px}
.seg button.active{background:rgba(110,168,254,.14);color:var(--text)}

.main{display:grid;grid-template-columns:340px 1fr;gap:12px;padding:12px;height:calc(100dvh - 56px)}
@media (max-width: 1060px){.main{grid-template-columns:1fr}}

aside, section{
  background:var(--panel);border:1px solid var(--border);border-radius:var(--radius);
  box-shadow:var(--shadow);overflow:hidden;min-height:0;
  display:flex;
  flex-direction:column;
  min-height:0;
}
aside{display:flex;flex-direction:column}
.aside-head{padding:12px;border-bottom:1px solid var(--border);background:var(--panel2);display:flex;align-items:flex-start;justify-content:space-between;gap:10px}
.aside-title{font-weight:750}
.aside-body{padding:12px;overflow:auto;min-height:0}
.aside-foot{padding:12px;border-top:1px solid var(--border);background:rgba(255,255,255,.02)}

.hint{color:var(--muted);font-size:12.5px}
.smallnote{font-size:12.5px;color:var(--muted)}
.mono{font-family:var(--mono)}
.right{margin-left:auto}
.nowrap{white-space:nowrap}

.kpi{display:flex;gap:10px;flex-wrap:wrap}
.chip{border:1px solid var(--border);background:rgba(255,255,255,.02);border-radius:999px;padding:6px 10px;font-size:12.5px;color:var(--muted)}

.tabs{display:flex;gap:8px;padding:10px 12px;border-bottom:1px solid var(--border);background:var(--panel2);align-items:center;flex-wrap:wrap}
.tab{border:1px solid var(--border);background:transparent;color:var(--muted);padding:7px 10px;border-radius:999px;cursor:pointer;font-size:13px}
.tab.active{background:rgba(110,168,254,.14);color:var(--text);border-color:rgba(110,168,254,.45)}
.content{padding:12px;overflow:auto;height:100%}
.content{
  flex:1;
  min-height:0;
  height:auto;
  padding-bottom: calc(12px + env(safe-area-inset-bottom) + 48px);
}

.status{display:inline-flex;align-items:center;gap:6px;font-size:12px;color:var(--muted)}
.dot{width:8px;height:8px;border-radius:999px;background:var(--ok)}
.dot.err{background:var(--danger)}

.group{margin-bottom:12px}
.group-head{display:flex;align-items:center;justify-content:space-between;gap:10px;margin-bottom:8px}
.group-title{font-weight:750}
.file-list{display:flex;flex-direction:column;gap:8px}
.file-item{
  border:1px solid var(--border);border-radius:12px;padding:10px;
  display:flex;flex-direction:column;gap:8px;background:rgba(255,255,255,.02);
}
.file-item.active{border-color:rgba(110,168,254,.55);box-shadow:0 0 0 3px rgba(110,168,254,.10)}
.file-row{display:flex;align-items:center;justify-content:space-between;gap:8px}
.file-name{font-weight:700;font-size:13.5px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
.file-actions{display:flex;gap:8px;flex-wrap:wrap;justify-content:flex-end}
.suffix-edit{display:flex;gap:8px;align-items:center}
.suffix-edit input{
  width:140px;padding:8px 10px;border-radius:10px;border:1px solid var(--border);
  background:var(--panel2);color:var(--text);outline:none;
}
.drag-handle{cursor:grab;color:var(--muted);user-select:none}
.dragging{opacity:.65}
.drop-hint{outline:2px dashed rgba(110,168,254,.35);outline-offset:2px}

.card{border:1px solid var(--border);border-radius:16px;padding:12px;background:rgba(255,255,255,.02)}
.card-head{display:flex;align-items:flex-start;justify-content:space-between;gap:10px;margin-bottom:8px}
.card-title{font-weight:800}
.card-actions{display:flex;gap:8px;flex-wrap:wrap;justify-content:flex-end}
.divider{height:1px;background:var(--border);margin:12px 0}
.card.collapsible .card-head{ cursor:pointer; }
.card.collapsed .card-body{ display:none; }
.collapse-icon{ margin-right:6px; color:var(--muted); font-family:var(--mono); }


.form{display:grid;grid-template-columns:1fr 1fr;gap:12px}
@media (max-width: 980px){.form{grid-template-columns:1fr}}
.field{display:flex;flex-direction:column;gap:6px}
label{font-size:13px;color:var(--muted)}
input[type="text"], input[type="number"], select, textarea{
  width:100%;padding:10px 10px;border-radius:12px;border:1px solid var(--border);
  background:var(--panel2);color:var(--text);outline:none;font-family:inherit;
}
textarea{min-height:92px;resize:vertical;font-family:var(--mono);font-size:12.5px;line-height:1.35}
.checkbox{display:flex;gap:8px;align-items:center;padding:9px 10px;border:1px solid var(--border);border-radius:12px;background:var(--panel2);color:var(--text)}
.checkbox input{transform:scale(1.05)}

.errbox{border:1px solid rgba(255,107,107,.45);background:rgba(255,107,107,.08);padding:10px 12px;border-radius:14px;color:var(--text)}
.okbox{border:1px solid rgba(81,207,102,.45);background:rgba(81,207,102,.08);padding:10px 12px;border-radius:14px;color:var(--text)}
.field-error input,.field-error textarea,.field-error select{border-color:rgba(255,107,107,.75);box-shadow:0 0 0 3px rgba(255,107,107,.12)}
.field-errtext{color:rgba(255,107,107,.95);font-size:12.5px}

/* Modal */
.modal.hidden{display:none}
.modal{position:fixed;inset:0;z-index:100}
.modal-backdrop{position:absolute;inset:0;background:rgba(0,0,0,.55)}
.modal-card{
  position:relative;max-width:720px;margin:8vh auto 0;
  background:var(--panel);border:1px solid var(--border);border-radius:16px;box-shadow:var(--shadow);
  overflow:hidden;
}
.modal-head{display:flex;align-items:center;justify-content:space-between;gap:10px;padding:12px;background:var(--panel2);border-bottom:1px solid var(--border)}
.modal-title{font-weight:850}
.modal-body{padding:12px;max-height:52vh;overflow:auto}
.modal-actions{display:flex;gap:10px;justify-content:flex-end;padding:12px;border-top:1px solid var(--border);background:rgba(255,255,255,.02)}
